{% extends "main/base.html" %}
{% load static %}
{% block main %}
    <style>
        /* Failed Page Specific Styles */
        .failed-container {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
            padding: var(--space-xxl) 0;
        }
        
        .failed-icon {
            width: 120px;
            height: 120px;
            background: var(--danger);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-xl);
            color: white;
            font-size: 3rem;
        }
        
        .failed-title {
            font-size: 2.5rem;
            margin-bottom: var(--space-md);
            color: var(--danger);
        }
        
        .failed-subtitle {
            font-size: 1.2rem;
            color: var(--primary-light);
            margin-bottom: var(--space-xl);
            line-height: 1.6;
        }
        
        .error-details {
            background: rgba(214, 48, 49, 0.1);
            border: 1px solid rgba(214, 48, 49, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin: var(--space-xl) 0;
            text-align: left;
        }
        
        .error-message {
            color: var(--danger);
            font-weight: 600;
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .error-solution {
            color: var(--primary-dark);
            line-height: 1.6;
        }
        
        .retry-section {
            background: var(--light-gray);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            margin: var(--space-xl) 0;
        }
        
        .retry-options {
            display: grid;
            gap: var(--space-md);
            margin-top: var(--space-lg);
        }
        
        .retry-option {
            background: white;
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            border: 2px solid var(--medium-gray);
            cursor: pointer;
            transition: all var(--transition-normal);
            text-align: left;
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }
        
        .retry-option:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .option-icon {
            width: 40px;
            height: 40px;
            background: var(--light-gray);
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 1.2rem;
        }
        
        .option-content h4 {
            margin-bottom: var(--space-xs);
            color: var(--primary-dark);
        }
        
        .option-content p {
            color: var(--primary-light);
            font-size: 0.9rem;
        }
        
        .action-buttons {
            display: flex;
            gap: var(--space-md);
            justify-content: center;
            margin-top: var(--space-xl);
            flex-wrap: wrap;
        }
        
        .contact-support {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-top: var(--space-xl);
            box-shadow: var(--glass-shadow);
        }
        
        @media (max-width: 768px) {
            .failed-container {
                padding: var(--space-xl) var(--space-md);
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-buttons .btn {
                width: 100%;
            }
        }
    </style>

    <!-- Main Content -->
    <main class="section">
        <div class="container">
            <div class="failed-container">
                <!-- Failed Icon -->
                <div class="failed-icon">
                    <i class="fas fa-times"></i>
                </div>
                
                <!-- Failed Message -->
                <h1 class="failed-title">Payment Failed</h1>
                <p class="failed-subtitle">
                    We couldn't process your payment. Please try again or use a different payment method.
                </p>
                
                <!-- Error Details -->
                <div class="error-details">
                    <div class="error-message">
                        <i class="fas fa-exclamation-circle"></i>
                        Payment Declined
                    </div>
                    <p class="error-solution">
                        Your payment was declined. This could be due to insufficient funds, 
                        incorrect card information, or security restrictions on your card.
                    </p>
                </div>
                
                <!-- Retry Options -->
                <div class="retry-section">
                    <h3 style="margin-bottom: var(--space-lg);">Try Another Method</h3>
                    
                    <div class="retry-options">
                        <!-- Retry Card -->
                        
                        <!-- PayPal -->
                        <form id="paypaloption" style="color: #0c0c0c;" action="{% url "payment" order_id %}" method="post">
                            {% csrf_token %}
                            <div class="retry-option" onclick="document.getElementById('paypaloption').submit();"; >
                            
                                <input type="hidden" name='method' value='paypal'>
                        <div class="option-icon">
                            <i class="fab fa-paypal"></i>
                            </div>
                            </form>
                            <div class="option-content">
                                <h4>Pay with PayPal</h4>
                                <p>Quick and secure payment through PayPal</p>
                            </div>
                        </div>
                         <form id="esewaoption" action="{% url "payment" order_id %}" method="post">
                            {% csrf_token %}
                            <input type="hidden" name='method' value='esewa'>
                        <div class="retry-option" onclick="document.getElementById('esewaoption').submit();">
                            <div class="option-icon">
                                <img src="{% static "images/icon.jpeg" %}" alt="eSewa Payment" style="width:50px;height:auto;">
                                
                            </div>
                            <div class="option-content">
                                <h4>Pay with Esewa</h4>
                                <p>Quick and secure payment through Esewa</p>
                            </div>
                        </div>
                      </form>
                    </div>
                </div>
                
                {% comment %} <!-- Contact Support -->
                <div class="contact-support">
                    <div style="display: flex; align-items: flex-start; gap: var(--space-md);">
                        <div style="color: var(--accent); font-size: 1.5rem;">
                            <i class="fas fa-headset"></i>
                        </div>
                        <div>
                            <h4 style="margin-bottom: var(--space-xs);">Need Help?</h4>
                            <p style="color: var(--primary-light); font-size: 0.95rem; margin-bottom: var(--space-md);">
                                Our support team is available 24/7 to help you complete your purchase.
                            </p>
                            <div style="display: flex; gap: var(--space-md); flex-wrap: wrap;">
                                <a href="/support/chat/" class="btn btn-outline" style="padding: var(--space-sm) var(--space-md);">
                                    <i class="fas fa-comment"></i> Live Chat
                                </a>
                                <a href="tel:1-800-123-4567" class="btn btn-outline" style="padding: var(--space-sm) var(--space-md);">
                                    <i class="fas fa-phone"></i> Call Support
                                </a>
                                <a href="mailto:support@example.com" class="btn btn-outline" style="padding: var(--space-sm) var(--space-md);">
                                    <i class="fas fa-envelope"></i> Email Us
                                </a>
                            </div>
                        </div>
                    </div>
                </div> {% endcomment %}
                
                <!-- Action Buttons -->
                <div class="action-buttons">
                    <a href="{% url "products" %}" class="btn btn-primary">
                        <i class="fas fa-redo"></i> Retry 
                    </a>
                    <a href="{% url "cart" %}" class="btn btn-secondary">
                        <i class="fas fa-shopping-cart"></i> Back to Cart
                    </a>
                    <a href="/" class="btn btn-outline">
                        <i class="fas fa-home"></i> Return to Home
                    </a>
                </div>
                
                <!-- Order Preserved Notice -->
                <div style="margin-top: var(--space-xl); padding-top: var(--space-lg); border-top: 1px solid var(--medium-gray);">
                    <div style="display: flex; align-items: center; gap: var(--space-md); color: var(--primary-light);">
                        <i class="fas fa-info-circle" style="color: var(--info);"></i>
                        <span style="font-size: 0.9rem;">
                            Your cart items have been saved. You can complete your purchase within the next 24 hours.
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    {% comment %} <script>
        // Auto redirect after 10 seconds for retry
        setTimeout(() => {
            document.querySelector('.retry-option').click();
        }, 10000);
    </script> {% endcomment %}
{% endblock main %}