{% extends "main/base.html" %}

 {% block main %}
    <main class="section">
        <div class="container">
            <div class="page-header">
                <h1 class="section-title">Shop Products</h1>
                <p class="page-subtitle">Discover our curated collection</p>
            </div>
            
            <div class="product-listing-container">
                <!-- Sidebar Filters -->
                    <aside class="filter-sidebar">

                    <div class="filter-group collapsible ">
                        <h3 class="filter-toggle">Filters â–¾</h3>

                        <div class="filter-content">
                        <form method="get">

                            <!-- Categories -->
                        <div class="filter-group">
                            <h3>Categories</h3>
                            <div class="filter-options">
                                <select name="category" class="filter-dropdown">
                                <option value="">All Categories</option>
                                {% for category in categories %}
                                    <option value="{{ category.name }}">
                                    {{ category.name }}
                                    </option>
                                {% endfor %}
                                </select>
                            </div>
                            </div>

                            <!-- Price -->
                            <div class="filter-group">
                            <h3>Price Range</h3>
                            <div class="price-range price-inputs">
                                <input type="number" name="min_price" placeholder="Min Price" class="price-input">
                                <input type="number" name="max_price" placeholder="Max Price" class="price-input">
                            </div>
                            </div>
                            <div class="container md-7"><a href="{% url "products" %}" class="btn btn-primary add-to-cart">
                                <i class="fa fa-refresh"></i> Reset Filters
                            </a></div>
                            <button class="btn btn-primary" type="submit" style="width:100%">Apply Filters</button>

                          </form>
                        </div>
                    </div>

                    </aside>

                
                <!-- Main Product Grid -->
                <div class="product-listing-main">
                    <!-- Toolbar -->
                    <div class="listing-toolbar">
                        <div class="toolbar-left">
                            <span class="results-count"> showing {{products.count}} </span>
                        </div>
                        <div class="toolbar-right">
                            <div class="view-toggle">
                                <button class="btn btn-icon btn-outline active">
                                    <i class="fas fa-th"></i>
                                </button>
                                <button class="btn btn-icon btn-outline">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                            {% comment %} <select class="sort-select">
                                <option value="popularity">Sort by: Popularity</option>
                                <option value="price-low">Price: Low to High</option>
                                <option value="price-high">Price: High to Low</option>
                                <option value="newest">Newest Arrivals</option>
                                <option value="rating">Highest Rated</option>
                            </select> {% endcomment %}
                        </div>
                    </div>
                    
                    <!-- Product Grid -->
                    <div class="product-grid">
                        {% for product in products %}
                     <div class="product-card">
                        <div class="product-badges">
                            {% if product.pip %}
                            <span class="badge badge-new"> {{product.pip}} </span>
                            {% endif %}
                            {% if product.previous_price %}
                            <span class="badge badge-sale"> -{{product.get_discount}}% </span>
                            {% endif %}
                        </div>
                        
                        <div class="quick-actions">
                            <button class="btn btn-icon btn-outline quick-view" data-product-id="1">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn btn-icon btn-outline add-to-wishlist" data-product-id="1">
                                <i class="fas fa-heart"></i>
                            </button>
                        </div>
                        <a href="{% url "product_detail" product.slug %}">
                        <div class="product-image">
                            {% if product.get_image_url %}
                            <img src="{{product.get_image_url}}" alt="{{product.name}}">
                             {% endif %}
                        </div>
                        
                        <div class="product-info">
                            <h3 class="product-title"> {{product.name}} </h3>
                            </a>
                            <div class="product-price">
                                <span class="current-price">${{product.price}} </span>
                                <span class="original-price">${{product.previous_price}} </span>
                            </div>
                            <div class="product-rating">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                                <span class="rating-count">(128)</span>
                            </div>
                            {% if product.id in user_cart %}
                           <button class="btn btn-success add-to-cart" data-product-id="{{ product.id }}">
                                <i class="fas fa-shopping-cart"></i> Added
                            </button>
                        {% else %}
                            <button class="btn btn-primary add-to-cart" data-product-id="{{ product.id }}">
                                <i class="fas fa-shopping-cart"></i> Add to Cart
                            </button>
                         {% endif %}  
                            <button class="btn btn-secondary" style="flex: 1;"><a href="{% url "buynow" product.slug %}">
                            <i class="fas fa-bolt"></i> Buy Now
                        </a></button>
                        </div>
                     </div>
                     {% endfor %}
                    </div>
                    
                    <!-- Pagination -->
                    <div class="pagination">
                        <button class="btn btn-outline">
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <div class="page-numbers">
                            <a href="#" class="active">1</a>
                            <a href="#">2</a>
                            <a href="#">3</a>
                            <span>...</span>
                            <a href="#">8</a>
                        </div>
                        <button class="btn btn-outline">
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

 {% endblock main %}    

